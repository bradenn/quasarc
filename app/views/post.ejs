<!DOCTYPE html>
<html lang="en">
<%- include("partials/header"); %>

<body>

  <%- include("partials/nav"); %>
  <br>
  <div class="container">

    <div class="row" style="margin-bottom: 16px;">

      <div class="col-md-9">
        <a href="/p/<%= post._id %>" class="no-hover">
          <div class="card bg-light">
            <p class="card-title-span"><%= post.title %></p>
            <div style="margin-left: 16px;">
              <span class="card-sub-span">by <a href="/u/<%= post.user %>" class="card-sub-span"><%= post.user %></a></span>
            </div>
            <div class="card-body">
              <p class="card-text"><%= post.post %></p>

            </div>
          </div>
        </a>

      </div>

      <div class="col-md-3"></div>
    </div>
    <div class="row" style="margin-bottom: 16px;">
      <div class="col-md-9" style="">
        <div class="card bg-light">
          <form id="post" action="/p/<%= post._id %>" class="comment-body" style="border:none; padding-left: 0;" method="post">
            <div class="form-group">
              <div class="row">
                <div class="col-md-10" style="">
                  <input class="form-control" type="text" id="body" name="body"></input>
                </div>
                <div class="col-md-2" style="">
                  <input class="btn btn-primary" type="submit" value="Post">
                </div>
              </div>
            </div>

          </form>
        </div>
      </div>
      <div class="col-md-3"></div>
    </div>
    <div class="row" style="margin-bottom: 16px;">
      <div class="col-md-9" style="margin-bottom: 16px;">
        <div class="card bg-light">
          <% for (var i = 0; i < post.comments.length; i++) { %>
          <div class="comment-body">
            <a href="/u/<%= post.comments[i].author %>" class="comment-header">u/<%= post.comments[i].author %></a>&nbsp;â€¢&nbsp;<span><%= timeSince(new Date(post.date)); %> ago</span><br>
            <span><%= post.comments[i].body %></span>
          </div>
          <% } %>
          <% if(post.comments.length <= 0){ %>
          <div class="comment-body">
            <span>No Comments</span>
          </div>
          <% } %>
        </div>
      </div>


      <div class="col-md-3"></div>
    </div>

  </div>

</body>

</html>
<%

function timeSince(date) {

  var seconds = Math.floor((new Date() - date) / 1000);

  var interval = Math.floor(seconds / 31536000);

  if (interval > 1) {
    return interval + " years";
  }
  interval = Math.floor(seconds / 2592000);
  if (interval > 1) {
    return interval + " months";
  }
  interval = Math.floor(seconds / 86400);
  if (interval > 1) {
    return interval + " days";
  }
  interval = Math.floor(seconds / 3600);
  if (interval > 1) {
    return interval + " hours";
  }
  interval = Math.floor(seconds / 60);
  if (interval > 1) {
    return interval + " minutes";
  }
  return Math.floor(seconds) + " seconds";
}
var aDay = 24*60*60*1000
%>
